<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scope 1 - Direct Emissions Data Entry</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#f5f6fa;--white:#fff;--text:#1a2233;--text2:#4f5d73;--text3:#8b95a5;--border:#e2e7ef;--bfocus:#9aa5b4;--accent:#e0533d;--accentbg:#fef1ef;--accentlt:#fcd5cf;--accentdk:#c43e2a;--green:#16a34a;--greenbg:#ecfdf5;--greenlt:#bbf7d0;--amber:#d97706;--amberbg:#fef9ee;--blue:#2563eb;--bluebg:#eff4ff;--bluelt:#bfdbfe;--red:#dc2626;--radius:14px;--radius2:10px}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
.app{max-width:1100px;margin:0 auto;padding:24px 20px 80px}
.topbar{display:flex;align-items:center;gap:12px;margin-bottom:22px;flex-wrap:wrap}
.topbar h2{font-size:20px;font-weight:800;letter-spacing:-.4px;display:flex;align-items:center;gap:8px}
.topbar h2 .sb{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:9px;background:var(--accent);color:#fff;font-size:14px;font-weight:800}
.topbar p{color:var(--text2);font-size:12.5px;flex:1;min-width:180px}
.btn-add{margin-left:auto;padding:9px 18px;border-radius:9px;background:var(--accent);color:#fff;border:none;font-family:inherit;font-size:13px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:6px;transition:background .15s;white-space:nowrap}
.btn-add:hover{background:var(--accentdk)}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin-bottom:20px}
.sc{background:var(--white);border:1px solid var(--border);border-radius:12px;padding:14px 16px;display:flex;align-items:center;gap:12px}
.sc .si{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0}
.sc .si.r{background:var(--accentbg)}.sc .si.g{background:var(--greenbg)}.sc .si.a{background:var(--amberbg)}.sc .si.p{background:#f5f3ff}
.sc .sv{font-size:18px;font-weight:800;letter-spacing:-.5px}.sc .sl{font-size:10.5px;color:var(--text3);margin-top:1px}
.ftabs{display:flex;gap:5px;margin-bottom:16px;flex-wrap:wrap}
.ftab{padding:7px 14px;border-radius:100px;font-size:11.5px;font-weight:600;cursor:pointer;border:1.5px solid var(--border);background:var(--white);color:var(--text2);transition:all .15s;display:flex;align-items:center;gap:4px}
.ftab:hover{border-color:var(--bfocus)}.ftab.on{background:var(--accentbg);border-color:var(--accentlt);color:var(--accent)}
.ftab .cn{font-size:9.5px;background:var(--bg);padding:1px 5px;border-radius:100px;font-weight:700}
.ftab.on .cn{background:var(--accentlt);color:var(--accentdk)}
.tw{background:var(--white);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.th2{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:8px}
.th2 h3{font-size:13.5px;font-weight:700}
.tsr{position:relative}.tsr input{padding:6px 9px 6px 28px;font-family:inherit;font-size:12px;border:1px solid var(--border);border-radius:7px;background:var(--bg);outline:none;width:180px;color:var(--text)}
.tsr svg{position:absolute;left:8px;top:50%;transform:translateY(-50%);width:13px;height:13px;color:var(--text3)}
table{width:100%;border-collapse:collapse}
table th{text-align:left;padding:8px 12px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--text3);background:var(--bg);border-bottom:1px solid var(--border)}
table td{padding:9px 12px;font-size:12px;border-bottom:1px solid var(--border);vertical-align:middle}
table tr:last-child td{border-bottom:none}table tr:hover td{background:#fafbfe}
.sn{font-weight:600;display:flex;align-items:center;gap:6px}
.cd{width:7px;height:7px;border-radius:50%;flex-shrink:0}.cd.st{background:#e0533d}.cd.mo{background:#d97706}.cd.fu{background:#7c3aed}
.ft2{display:inline-block;padding:2px 7px;border-radius:5px;font-size:10px;font-weight:600;background:var(--bg);color:var(--text2);border:1px solid var(--border)}
.co2val{font-weight:700;color:var(--accent)}
.ab{width:26px;height:26px;border-radius:6px;border:1px solid var(--border);background:var(--white);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:11px;color:var(--text3);transition:all .1s}
.ab.dl:hover{background:#fef2f2;color:var(--red);border-color:#fecaca}
.es{text-align:center;padding:40px 20px;color:var(--text3)}.es span{font-size:34px;display:block;margin-bottom:6px}
.es p{font-size:13px;margin-bottom:10px}.es .eb{padding:6px 14px;border-radius:7px;background:var(--accent);color:#fff;border:none;font-family:inherit;font-size:11.5px;font-weight:600;cursor:pointer}
.ov{position:fixed;inset:0;background:rgba(12,18,30,.5);backdrop-filter:blur(3px);z-index:1000;display:none;align-items:flex-start;justify-content:center;padding:20px 12px;overflow-y:auto;opacity:0;transition:opacity .2s}.ov.open{display:flex;opacity:1}
.mdl{background:var(--white);border-radius:16px;width:100%;max-width:600px;box-shadow:0 20px 60px rgba(0,0,0,.18);margin:auto;overflow:hidden}
.mh{padding:18px 20px 0;display:flex;align-items:center;gap:11px}
.mh .mi{width:42px;height:42px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:var(--accentbg)}
.mh .mt{flex:1}.mh .mt h2{font-size:15px;font-weight:700}.mh .mt span{font-size:10.5px;color:var(--text3)}
.mh .mx{width:30px;height:30px;border-radius:7px;border:1px solid var(--border);background:var(--white);cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--text2);font-size:15px;flex-shrink:0}
.stp{display:flex;padding:14px 20px 0}
.st{flex:1;text-align:center;padding-bottom:12px;position:relative}
.st .sb3{position:absolute;bottom:0;left:0;right:0;height:3px;background:var(--border);border-radius:2px}
.st.dn .sb3{background:var(--green)}.st.ac2 .sb3{background:var(--accent)}
.st .sn2{width:22px;height:22px;border-radius:50%;border:2px solid var(--border);display:inline-flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:var(--text3);margin-bottom:2px}
.st.ac2 .sn2{border-color:var(--accent);background:var(--accent);color:#fff}
.st.dn .sn2{border-color:var(--green);background:var(--green);color:#fff}
.st .stx{font-size:9.5px;font-weight:600;color:var(--text3)}.st.ac2 .stx{color:var(--accent)}.st.dn .stx{color:var(--green)}
.fp{padding:16px 20px 20px;display:none}.fp.show{display:block}
.fg{margin-bottom:12px}.fg label{display:block;font-size:11.5px;font-weight:600;margin-bottom:3px}.fg label .rq{color:var(--red);margin-left:1px}
.fg .fh{font-size:10px;color:var(--text3);margin-bottom:3px}
.fi,.fsl,.fta{width:100%;padding:8px 11px;font-family:inherit;font-size:12.5px;border:1.5px solid var(--border);border-radius:var(--radius2);background:var(--white);outline:none;color:var(--text);transition:border .2s}
.fi:focus,.fsl:focus,.fta:focus{border-color:var(--bfocus)}.fi::placeholder,.fta::placeholder{color:var(--text3)}
.fsl{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238b95a5' stroke-width='2.5'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 10px center;padding-right:28px;cursor:pointer}
.fta{resize:vertical;min-height:52px}.fr{display:flex;gap:10px}.fr .fg{flex:1}
.scb{display:flex;gap:4px;margin-bottom:10px;flex-wrap:wrap}
.scbt{padding:5px 12px;border-radius:100px;font-size:11px;font-weight:600;cursor:pointer;border:1.5px solid var(--border);background:var(--white);color:var(--text2);transition:all .12s}
.scbt:hover{border-color:var(--bfocus)}.scbt.on{background:var(--accentbg);border-color:var(--accentlt);color:var(--accent)}
.sg{display:grid;grid-template-columns:1fr 1fr;gap:5px;max-height:240px;overflow-y:auto;padding-right:3px}
.sg::-webkit-scrollbar{width:3px}.sg::-webkit-scrollbar-thumb{background:#d0d5dd;border-radius:2px}
.sc2{padding:9px 10px;border:1.5px solid var(--border);border-radius:var(--radius2);cursor:pointer;transition:all .1s;display:flex;align-items:center;gap:7px}
.sc2:hover{border-color:var(--bfocus);background:#fafbfd}.sc2.pk{border-color:var(--accent);background:var(--accentbg)}
.sc2 .sd2{width:6px;height:6px;border-radius:50%;background:var(--border);flex-shrink:0}.sc2.pk .sd2{background:var(--accent)}
.sc2 .sn3{font-size:11px;font-weight:600;line-height:1.2}.sc2 .sd3{font-size:9.5px;color:var(--text3);margin-top:1px;line-height:1.2}
.ef-box{margin:10px 0 12px;padding:12px;border-radius:var(--radius2);background:var(--bluebg);border:1px solid var(--bluelt)}
.ef-box .ef-title{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--blue);margin-bottom:6px;display:flex;align-items:center;gap:5px}
.ef-row{display:flex;gap:8px;flex-wrap:wrap}
.ef-item{flex:1;min-width:80px;background:var(--white);border:1px solid var(--bluelt);border-radius:7px;padding:7px 8px;text-align:center}
.ef-item .ef-val{font-size:14px;font-weight:800;color:var(--blue);letter-spacing:-.3px}
.ef-item .ef-lbl{font-size:8.5px;color:var(--text3);margin-top:1px;text-transform:uppercase;letter-spacing:.3px}
.co2box{padding:14px;border-radius:var(--radius2);text-align:center;margin-bottom:12px;background:var(--accentbg);border:1.5px solid var(--accentlt)}
.co2box .co2v{font-size:26px;font-weight:800;letter-spacing:-1px;color:var(--accent)}
.co2box .co2l{font-size:10.5px;color:var(--text2);margin-top:1px}.co2box .co2f{font-size:9.5px;color:var(--text3);margin-top:3px;font-style:italic}
.fup{border:2px dashed var(--border);border-radius:var(--radius2);padding:14px;text-align:center;cursor:pointer;transition:all .2s;background:var(--bg)}
.fup:hover{border-color:var(--bfocus)}.fup input{display:none}.fup .fut{font-size:11.5px;color:var(--text2)}.fup .fuh{font-size:9.5px;color:var(--text3);margin-top:1px}
.ffl{margin-top:5px;display:flex;flex-wrap:wrap;gap:3px}
.ffi{display:inline-flex;align-items:center;gap:3px;padding:3px 7px;border-radius:5px;background:var(--bg);border:1px solid var(--border);font-size:10px;color:var(--text2)}
.ffi .ffx{cursor:pointer;color:var(--text3);font-weight:700}.ffi .ffx:hover{color:var(--red)}
.ferr .fi,.ferr .fsl{border-color:var(--red)}.fem{font-size:9.5px;color:var(--red);margin-top:2px;display:none}.ferr .fem{display:block}
.fn{display:flex;gap:8px;margin-top:6px;padding-top:12px;border-top:1px solid var(--border)}
.btn{padding:8px 16px;border-radius:var(--radius2);font-family:inherit;font-size:12px;font-weight:600;cursor:pointer;transition:all .12s;border:none}
.bp{flex:1;background:var(--accent);color:#fff}.bp:hover{background:var(--accentdk)}
.bs{background:var(--bg);color:var(--text2);border:1px solid var(--border)}.bs:hover{background:#e8eaf0}
.bg{background:var(--green);color:#fff;flex:1}.bg:hover{background:#148c3e}
.suc{display:none;text-align:center;padding:32px 20px}.suc.on{display:block}
.suc .sk{width:52px;height:52px;border-radius:50%;background:var(--greenbg);border:2px solid var(--greenlt);display:inline-flex;align-items:center;justify-content:center;font-size:22px;margin-bottom:8px}
.suc h3{font-size:15px;font-weight:700;color:var(--green);margin-bottom:3px}
.suc p{font-size:12px;color:var(--text2);line-height:1.5;margin-bottom:12px}.suc .sr{display:flex;gap:8px;justify-content:center}
.nav-link{display:inline-flex;align-items:center;gap:5px;padding:6px 14px;border-radius:8px;font-size:11px;font-weight:600;text-decoration:none;border:1.5px solid var(--border);color:var(--text2);background:var(--white);transition:all .15s;margin-right:6px}
.nav-link:hover{border-color:var(--bfocus);background:var(--bg)}
.nav-link.s2{border-color:#fde68a;color:#b45d05;background:#fef9ee}
.nav-link.s3{border-color:#a5f3fc;color:#0e7490;background:#ecfeff}
@media(max-width:640px){.app{padding:14px 10px 60px}.stats{grid-template-columns:1fr 1fr}.sg{grid-template-columns:1fr}.fr{flex-direction:column;gap:0}.ef-row{flex-direction:column;gap:5px}}
</style>
</head>
<body>
<div class="app">
  <div style="margin-bottom:16px"><a class="nav-link s2" href="scope2-data-entry.html">&#9889; Scope 2</a><a class="nav-link s3" href="scope3-data-entry.html">&#127760; Scope 3</a></div>
  <div class="topbar">
    <h2><span class="sb">1</span>Scope 1 - Direct Emissions</h2>
    <p>Fuel combustion, company vehicles, fugitive gas leaks</p>
    <button class="btn-add" id="btnAdd">+ Add Entry</button>
  </div>
  <div class="stats">
    <div class="sc"><div class="si r">&#128293;</div><div><div class="sv" id="sT">0</div><div class="sl">Total Entries</div></div></div>
    <div class="sc"><div class="si g">&#9981;</div><div><div class="sv" id="sS">0</div><div class="sl">Stationary</div></div></div>
    <div class="sc"><div class="si a">&#128663;</div><div><div class="sv" id="sM">0</div><div class="sl">Mobile</div></div></div>
    <div class="sc"><div class="si p">&#128168;</div><div><div class="sv" id="sF">0</div><div class="sl">Fugitive</div></div></div>
  </div>
  <div class="ftabs" id="fTabs"></div>
  <div class="tw"><div class="th2"><h3>Entries</h3><div class="tsr"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg><input type="text" id="tSr" placeholder="Search..."></div></div><div id="tB"></div></div>
</div>
<div class="ov" id="ov">
<div class="mdl">
  <div class="mh"><div class="mi">&#128293;</div><div class="mt"><h2>New Scope 1 Entry</h2><span>Direct Emissions</span></div><button class="mx" id="mx">&#x2715;</button></div>
  <div class="stp"><div class="st ac2" id="ms1"><span class="sn2">1</span><div class="stx">Source</div><div class="sb3"></div></div><div class="st" id="ms2"><span class="sn2">2</span><div class="stx">Data</div><div class="sb3"></div></div><div class="st" id="ms3"><span class="sn2">3</span><div class="stx">Review</div><div class="sb3"></div></div></div>
  <div class="fp show" id="p1"><div class="fg"><label>Sub-Category<span class="rq">*</span></label><div class="scb" id="scb"></div></div><div class="fg" id="fg_src"><label>Emission Source<span class="rq">*</span></label><div class="fh">Select fuel type</div><div class="sg" id="srcG"></div><div class="fem">Please select a source</div></div><div class="fn"><button class="btn bs" id="n1c">Cancel</button><button class="btn bp" id="n1n">Next &#8594;</button></div></div>
  <div class="fp" id="p2"><div class="ef-box" id="efBox" style="display:none"><div class="ef-title">&#128218; Emission Factors (auto-applied)</div><div class="ef-row" id="efRow"></div></div><div class="fr"><div class="fg" id="fg_qty"><label>Quantity<span class="rq">*</span></label><input class="fi" type="number" id="fqty" placeholder="e.g. 5000" step="any" min="0"><div class="fem">Enter quantity</div></div><div class="fg" id="fg_unit"><label>Unit<span class="rq">*</span></label><select class="fsl" id="funit"><option value="">Select...</option></select><div class="fem">Select unit</div></div></div><div class="co2box" id="co2box" style="display:none"><div class="co2v" id="co2v">0.00</div><div class="co2l">tonnes CO2e</div><div class="co2f" id="co2f"></div></div><div class="fr"><div class="fg" id="fg_per"><label>Period<span class="rq">*</span></label><select class="fsl" id="fper"><option value="">Select...</option><option>Monthly</option><option>Quarterly</option><option>Annually</option></select><div class="fem">Select period</div></div><div class="fg" id="fg_dt"><label>Date<span class="rq">*</span></label><input class="fi" type="date" id="fdt"><div class="fem">Select date</div></div></div><div class="fg" id="fg_fac"><label>Facility / Location<span class="rq">*</span></label><input class="fi" type="text" id="ffac" placeholder="e.g. Main Office"><div class="fem">Enter facility</div></div><div class="fg"><label>Notes</label><textarea class="fta" id="fdsc" placeholder="Optional..."></textarea></div><div class="fn"><button class="btn bs" id="n2b">&#8592; Back</button><button class="btn bp" id="n2n">Next &#8594;</button></div></div>
  <div class="fp" id="p3"><div class="fg"><label>Upload Evidence</label><div class="fup" id="fup"><span style="font-size:18px">&#128206;</span><div class="fut">Click to upload</div><div class="fuh">PDF, PNG, JPG, XLSX</div><input type="file" id="fupi" multiple></div><div class="ffl" id="ffl"></div></div><div class="fg"><label>Summary</label><div id="rvw" style="padding:10px;border-radius:9px;background:var(--bg);border:1px solid var(--border);font-size:12px;line-height:1.8;color:var(--text2)"></div></div><div class="fn"><button class="btn bs" id="n3b">&#8592; Back</button><button class="btn bg" id="n3s">&#10003; Submit</button></div></div>
  <div class="suc" id="suc"><div class="sk">&#10003;</div><h3>Saved!</h3><p id="sucM"></p><div class="sr"><button class="btn bs" id="sucC">Close</button><button class="btn bp" id="sucA">+ Another</button></div></div>
</div>
</div>
<script>
(function(){
var GWP_CH4=28,GWP_N2O=265;
var S={
stationary:[
  {name:"Biomass Combustion",desc:"Biomass for heat/power",units:[{u:"kg",label:"Kilograms (kg)",co2:0,ch4:30,n2o:4,ncv:0.0000156},{u:"tonnes",label:"Tonnes (t)",co2:0,ch4:30,n2o:4,ncv:0.0156}],note:"Biogenic CO2 not counted. IPCC Table 2.4/2.5"},
  {name:"Coal Combustion",desc:"Coal in boilers",units:[{u:"kg",label:"Kilograms (kg)",co2:2.42,ch4:1,n2o:1.5,ncv:0.0000261},{u:"tonnes",label:"Tonnes (t)",co2:2420,ch4:1,n2o:1.5,ncv:0.0261}],note:"IPCC 98300 kgCO2/TJ"},
  {name:"Diesel (Stationary)",desc:"Generators, boilers",units:[{u:"liters",label:"Liters (L)",co2:2.676,ch4:3,n2o:0.6,ncv:0.0000359},{u:"gallons",label:"Gallons (gal)",co2:10.13,ch4:3,n2o:0.6,ncv:0.000136}],note:"IPCC 74100 kgCO2/TJ"},
  {name:"Fuel Oil (Heating Oil)",desc:"Residual fuel",units:[{u:"liters",label:"Liters (L)",co2:2.96,ch4:3,n2o:0.6,ncv:0.0000388},{u:"gallons",label:"Gallons (gal)",co2:11.21,ch4:3,n2o:0.6,ncv:0.000147}],note:"IPCC 77400 kgCO2/TJ"},
  {name:"Gasoline (Stationary)",desc:"Stationary engines",units:[{u:"liters",label:"Liters (L)",co2:2.315,ch4:3,n2o:0.6,ncv:0.0000323},{u:"gallons",label:"Gallons (gal)",co2:8.764,ch4:3,n2o:0.6,ncv:0.000122}],note:"IPCC 69300 kgCO2/TJ"},
  {name:"Kerosene",desc:"Heaters, generators",units:[{u:"liters",label:"Liters (L)",co2:2.538,ch4:3,n2o:0.6,ncv:0.0000349},{u:"gallons",label:"Gallons (gal)",co2:9.607,ch4:3,n2o:0.6,ncv:0.000132}],note:"IPCC 71900 kgCO2/TJ"},
  {name:"LPG / Propane",desc:"LPG combustion",units:[{u:"liters",label:"Liters (L)",co2:1.555,ch4:1,n2o:0.1,ncv:0.0000261},{u:"kg",label:"Kilograms (kg)",co2:2.983,ch4:1,n2o:0.1,ncv:0.0000473}],note:"IPCC 63100 kgCO2/TJ"},
  {name:"Natural Gas",desc:"Boilers, furnaces, CHP",units:[{u:"m3",label:"Cubic Meters (m3)",co2:2.024,ch4:1,n2o:0.1,ncv:0.0000364},{u:"kWh",label:"kWh",co2:0.202,ch4:1,n2o:0.1,ncv:0.0000036},{u:"therms",label:"Therms",co2:5.31,ch4:1,n2o:0.1,ncv:0.0001055}],note:"IPCC 56100 kgCO2/TJ"},
  {name:"Wood / Pellets",desc:"Wood heating",units:[{u:"kg",label:"Kilograms (kg)",co2:0,ch4:30,n2o:4,ncv:0.0000156},{u:"tonnes",label:"Tonnes (t)",co2:0,ch4:30,n2o:4,ncv:0.0156}],note:"Biogenic CO2 not counted"}
],mobile:[
  {name:"Aviation - Jet Fuel",desc:"Company aircraft",units:[{u:"liters",label:"Liters (L)",co2:2.534,ch4:0.5,n2o:2,ncv:0.0000349},{u:"gallons",label:"Gallons (gal)",co2:9.593,ch4:0.5,n2o:2,ncv:0.000132}],note:"IPCC 71500 kgCO2/TJ"},
  {name:"Fleet - Biodiesel",desc:"Biodiesel vehicles",units:[{u:"liters",label:"Liters (L)",co2:0,ch4:3,n2o:0.6,ncv:0.0000337},{u:"gallons",label:"Gallons (gal)",co2:0,ch4:3,n2o:0.6,ncv:0.000128}],note:"Biogenic CO2 not counted"},
  {name:"Fleet - CNG",desc:"CNG fleet",units:[{u:"kg",label:"Kilograms (kg)",co2:2.743,ch4:92,n2o:3,ncv:0.0000480}],note:"IPCC 56100 kgCO2/TJ mobile"},
  {name:"Fleet - Diesel",desc:"Diesel cars/vans",units:[{u:"liters",label:"Liters (L)",co2:2.676,ch4:3.9,n2o:3.9,ncv:0.0000359},{u:"gallons",label:"Gallons (gal)",co2:10.13,ch4:3.9,n2o:3.9,ncv:0.000136}],note:"IPCC 74100 kgCO2/TJ mobile"},
  {name:"Fleet - Gasoline",desc:"Gasoline cars/vans",units:[{u:"liters",label:"Liters (L)",co2:2.315,ch4:3.5,n2o:5.7,ncv:0.0000323},{u:"gallons",label:"Gallons (gal)",co2:8.764,ch4:3.5,n2o:5.7,ncv:0.000122}],note:"IPCC 69300 kgCO2/TJ mobile"},
  {name:"Fleet - LPG",desc:"LPG vehicles",units:[{u:"liters",label:"Liters (L)",co2:1.555,ch4:62,n2o:0.2,ncv:0.0000261}],note:"IPCC 63100 kgCO2/TJ mobile"},
  {name:"Marine - Diesel",desc:"Vessel diesel",units:[{u:"liters",label:"Liters (L)",co2:2.676,ch4:7,n2o:2,ncv:0.0000359},{u:"tonnes",label:"Tonnes (t)",co2:3188,ch4:7,n2o:2,ncv:0.0431}],note:"IPCC 74100 kgCO2/TJ marine"},
  {name:"Marine - HFO",desc:"HFO vessels",units:[{u:"liters",label:"Liters (L)",co2:3.114,ch4:7,n2o:2,ncv:0.0000404},{u:"tonnes",label:"Tonnes (t)",co2:3206,ch4:7,n2o:2,ncv:0.0404}],note:"IPCC 77400 kgCO2/TJ marine"},
  {name:"Off-road - Diesel",desc:"Construction/mining",units:[{u:"liters",label:"Liters (L)",co2:2.676,ch4:4.15,n2o:28.6,ncv:0.0000359},{u:"gallons",label:"Gallons (gal)",co2:10.13,ch4:4.15,n2o:28.6,ncv:0.000136}],note:"IPCC off-road Table 3.3.1"},
  {name:"Rail - Diesel",desc:"Company locomotives",units:[{u:"liters",label:"Liters (L)",co2:2.676,ch4:4.15,n2o:28.6,ncv:0.0000359},{u:"gallons",label:"Gallons (gal)",co2:10.13,ch4:4.15,n2o:28.6,ncv:0.000136}],note:"IPCC rail diesel"}
],fugitive:[
  {name:"Fire Suppression (Halon)",desc:"Halon systems",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:0,note:"Halon ODP substance"},
  {name:"Fire Suppression (HFCs)",desc:"HFC fire systems",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:3220,note:"HFC-227ea GWP=3220 AR5"},
  {name:"Methane Leakage",desc:"Gas pipe leaks",units:[{u:"kg",label:"Kilograms (kg)"},{u:"m3",label:"Cubic Meters (m3)"}],isFug:true,gwp:28,gwpM3:18.76,note:"CH4 GWP=28 AR5"},
  {name:"N2O from Processes",desc:"Industrial N2O",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:265,note:"N2O GWP=265 AR5"},
  {name:"PFCs (Aluminium)",desc:"PFC production",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:7390,note:"CF4 GWP=7390 AR5"},
  {name:"Refrigerant (CFCs)",desc:"CFC HVAC leaks",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:10900,note:"CFC-12 GWP=10900"},
  {name:"Refrigerant (HCFCs)",desc:"HCFC e.g. R-22",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:1810,note:"HCFC-22 GWP=1810"},
  {name:"Refrigerant (HFCs)",desc:"HFC e.g. R-410A",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:2088,note:"R-410A GWP=2088"},
  {name:"Refrigerant (HFOs)",desc:"HFO/natural refrig",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:4,note:"HFO GWP<4"},
  {name:"SF6 (Electrical)",desc:"SF6 switchgear",units:[{u:"kg",label:"Kilograms (kg)"}],isFug:true,gwp:23500,note:"SF6 GWP=23500 AR5"}
]};
var entries=[],curSub="stationary",selSrc=null,upFiles=[],filterCat="all",curStep=1;
var cats={all:"All",stationary:"Stationary",mobile:"Mobile",fugitive:"Fugitive"};
var wrap=document.getElementById("fTabs");
Object.keys(cats).forEach(function(k){var t=document.createElement("div");t.className="ftab"+(k==="all"?" on":"");t.setAttribute("data-f",k);t.innerHTML=cats[k]+' <span class="cn">0</span>';t.addEventListener("click",function(){wrap.querySelectorAll(".ftab").forEach(function(x){x.classList.remove("on");});t.classList.add("on");filterCat=k;renderT();});wrap.appendChild(t);});
function openM(){selSrc=null;upFiles=[];resetForm();curSub="stationary";renderSubBtns();renderSrcCards();goStep(1);document.getElementById("suc").classList.remove("on");document.getElementById("ov").classList.add("open");document.body.style.overflow="hidden";}
function closeM(){document.getElementById("ov").classList.remove("open");document.body.style.overflow="";}
function renderSubBtns(){var c=document.getElementById("scb");c.innerHTML="";["stationary","mobile","fugitive"].forEach(function(k){var b=document.createElement("div");b.className="scbt"+(curSub===k?" on":"");b.textContent=cats[k];b.addEventListener("click",function(){curSub=k;c.querySelectorAll(".scbt").forEach(function(x){x.classList.remove("on");});b.classList.add("on");renderSrcCards();});c.appendChild(b);});}
function renderSrcCards(){selSrc=null;var g=document.getElementById("srcG");g.innerHTML="";(S[curSub]||[]).forEach(function(s){var d=document.createElement("div");d.className="sc2";d.innerHTML='<div class="sd2"></div><div><div class="sn3">'+s.name+'</div><div class="sd3">'+s.desc+'</div></div>';d.addEventListener("click",function(){g.querySelectorAll(".sc2").forEach(function(x){x.classList.remove("pk");});d.classList.add("pk");selSrc=s;document.getElementById("fg_src").classList.remove("ferr");});g.appendChild(d);});}
function populateUnits(){var sel=document.getElementById("funit");sel.innerHTML='<option value="">Select...</option>';selSrc.units.forEach(function(u,i){var o=document.createElement("option");o.value=i;o.textContent=u.label;sel.appendChild(o);});}
function showEF(){var b=document.getElementById("efBox");b.style.display="none";if(!selSrc)return;b.style.display="block";if(selSrc.isFug){document.getElementById("efRow").innerHTML='<div class="ef-item"><div class="ef-val">'+selSrc.gwp.toLocaleString()+'</div><div class="ef-lbl">GWP (AR5)</div></div>';}else{var u=selSrc.units[0];document.getElementById("efRow").innerHTML='<div class="ef-item"><div class="ef-val">'+u.co2+'</div><div class="ef-lbl">kgCO2/'+u.label.split("(")[0].trim()+'</div></div><div class="ef-item"><div class="ef-val">'+u.ch4+'</div><div class="ef-lbl">kgCH4/TJ</div></div><div class="ef-item"><div class="ef-val">'+u.n2o+'</div><div class="ef-lbl">kgN2O/TJ</div></div>';}}
function calcCO2e(){var box=document.getElementById("co2box");if(!selSrc){box.style.display="none";return 0;}var qty=parseFloat(document.getElementById("fqty").value),uIdx=document.getElementById("funit").value;if(!qty||qty<=0||uIdx===""){box.style.display="none";return 0;}uIdx=parseInt(uIdx);var uD=selSrc.units[uIdx];var t=0;if(selSrc.isFug){var gwp=selSrc.gwp;if(uD.u==="m3"&&selSrc.gwpM3)gwp=selSrc.gwpM3;t=(qty*gwp)/1000;document.getElementById("co2f").textContent=qty+" "+uD.label.split("(")[0].trim()+" x GWP "+gwp+" = "+t.toFixed(4)+" tCO2e";}else{var co2=qty*uD.co2,tj=qty*uD.ncv,ch4=tj*uD.ch4,n2o=tj*uD.n2o;t=co2/1000+(ch4*GWP_CH4)/1000+(n2o*GWP_N2O)/1000;document.getElementById("co2f").textContent="CO2:"+(co2/1000).toFixed(4)+"t CH4:"+(ch4*GWP_CH4/1000).toFixed(4)+"t N2O:"+(n2o*GWP_N2O/1000).toFixed(4)+"t";}document.getElementById("co2v").textContent=t.toFixed(4);box.style.display="block";return t;}
function goStep(n){curStep=n;for(var i=1;i<=3;i++){document.getElementById("p"+i).classList.toggle("show",i===n);var el=document.getElementById("ms"+i);if(el){el.className="st"+(i<n?" dn":"")+(i===n?" ac2":"");}}}
function resetForm(){["fqty","fdt","ffac","fdsc"].forEach(function(id){document.getElementById(id).value="";});document.getElementById("funit").innerHTML='<option value="">Select...</option>';document.getElementById("fper").value="";document.getElementById("ffl").innerHTML="";document.getElementById("co2box").style.display="none";document.getElementById("efBox").style.display="none";upFiles=[];document.querySelectorAll(".ferr").forEach(function(e){e.classList.remove("ferr");});}
document.getElementById("btnAdd").addEventListener("click",openM);
document.getElementById("mx").addEventListener("click",closeM);
document.getElementById("n1c").addEventListener("click",closeM);
document.getElementById("ov").addEventListener("click",function(e){if(e.target===this)closeM();});
document.getElementById("n1n").addEventListener("click",function(){if(!selSrc){document.getElementById("fg_src").classList.add("ferr");return;}populateUnits();showEF();goStep(2);});
document.getElementById("n2b").addEventListener("click",function(){goStep(1);});
document.getElementById("n2n").addEventListener("click",function(){document.querySelectorAll(".ferr").forEach(function(e){e.classList.remove("ferr");});var ok=true;if(!document.getElementById("fqty").value||parseFloat(document.getElementById("fqty").value)<=0){document.getElementById("fg_qty").classList.add("ferr");ok=false;}if(document.getElementById("funit").value===""){document.getElementById("fg_unit").classList.add("ferr");ok=false;}if(!document.getElementById("fper").value){document.getElementById("fg_per").classList.add("ferr");ok=false;}if(!document.getElementById("fdt").value){document.getElementById("fg_dt").classList.add("ferr");ok=false;}if(!document.getElementById("ffac").value.trim()){document.getElementById("fg_fac").classList.add("ferr");ok=false;}if(!ok)return;var t=calcCO2e();var uIdx=parseInt(document.getElementById("funit").value);document.getElementById("rvw").innerHTML="<strong>Source:</strong> "+selSrc.name+"<br><strong>Quantity:</strong> "+document.getElementById("fqty").value+" "+selSrc.units[uIdx].label+"<br><strong>Emissions:</strong> <span style='color:var(--accent);font-weight:700'>"+t.toFixed(4)+" tCO2e</span><br><strong>EF:</strong> "+selSrc.note+"<br><strong>Period:</strong> "+document.getElementById("fper").value+" | "+document.getElementById("fdt").value+"<br><strong>Facility:</strong> "+document.getElementById("ffac").value;goStep(3);});
document.getElementById("n3b").addEventListener("click",function(){goStep(2);});
document.getElementById("n3s").addEventListener("click",function(){var t=calcCO2e();var uIdx=parseInt(document.getElementById("funit").value);entries.push({source:selSrc.name,subcat:curSub,qty:parseFloat(document.getElementById("fqty").value),unit:selSrc.units[uIdx].label,co2e:t,period:document.getElementById("fper").value,date:document.getElementById("fdt").value,facility:document.getElementById("ffac").value.trim(),note:selSrc.note});renderT();updateStats();document.getElementById("sucM").textContent=selSrc.name+" | "+t.toFixed(4)+" tCO2e";document.querySelectorAll(".fp").forEach(function(p){p.classList.remove("show");});document.getElementById("suc").classList.add("on");});
document.getElementById("sucC").addEventListener("click",closeM);
document.getElementById("sucA").addEventListener("click",function(){document.getElementById("suc").classList.remove("on");resetForm();curSub="stationary";renderSubBtns();renderSrcCards();goStep(1);});
document.getElementById("fqty").addEventListener("input",calcCO2e);
document.getElementById("funit").addEventListener("change",function(){showEF();calcCO2e();});
var fup=document.getElementById("fup"),fupi=document.getElementById("fupi");fup.addEventListener("click",function(){fupi.click();});fupi.addEventListener("change",function(){for(var i=0;i<this.files.length;i++)upFiles.push(this.files[i]);renderFiles();this.value="";});
function renderFiles(){var c=document.getElementById("ffl");c.innerHTML="";upFiles.forEach(function(f,i){var d=document.createElement("div");d.className="ffi";d.innerHTML=f.name+' <span class="ffx">&times;</span>';d.querySelector(".ffx").addEventListener("click",function(){upFiles.splice(i,1);renderFiles();});c.appendChild(d);});}
function renderT(){var tb=document.getElementById("tB"),sq=(document.getElementById("tSr").value||"").toLowerCase();var f=entries.filter(function(e){return filterCat==="all"||e.subcat===filterCat;});if(sq)f=f.filter(function(e){return e.source.toLowerCase().indexOf(sq)!==-1||e.facility.toLowerCase().indexOf(sq)!==-1;});if(!f.length){tb.innerHTML='<div class="es"><span>&#128293;</span><p>'+(entries.length?"No match.":"No entries yet.")+'</p>'+(entries.length?'':'<button class="eb" onclick="document.getElementById(\'btnAdd\').click()">+ Add</button>')+'</div>';return;}var h='<table><thead><tr><th>Source</th><th>Qty</th><th>tCO2e</th><th>Facility</th><th>Date</th><th></th></tr></thead><tbody>';f.forEach(function(e){var ri=entries.indexOf(e);var dc=e.subcat==="stationary"?"st":e.subcat==="mobile"?"mo":"fu";h+='<tr><td><div class="sn"><span class="cd '+dc+'"></span>'+e.source+'</div></td><td>'+e.qty+' '+e.unit.split("(")[0].trim()+'</td><td><span class="co2val">'+e.co2e.toFixed(4)+'</span></td><td><span class="ft2">'+e.facility+'</span></td><td>'+e.date+'</td><td><button class="ab dl" data-i="'+ri+'">&#128465;</button></td></tr>';});h+='</tbody></table>';tb.innerHTML=h;tb.querySelectorAll(".dl").forEach(function(b){b.addEventListener("click",function(){if(!confirm("Delete?"))return;entries.splice(parseInt(b.getAttribute("data-i")),1);renderT();updateStats();});});}
document.getElementById("tSr").addEventListener("input",renderT);
function updateStats(){var t=entries.length,s=0,m=0,f=0;entries.forEach(function(e){if(e.subcat==="stationary")s++;else if(e.subcat==="mobile")m++;else f++;});document.getElementById("sT").textContent=t;document.getElementById("sS").textContent=s;document.getElementById("sM").textContent=m;document.getElementById("sF").textContent=f;var tabs=document.getElementById("fTabs").querySelectorAll(".ftab");tabs.forEach(function(tab){var k=tab.getAttribute("data-f");var c=k==="all"?t:k==="stationary"?s:k==="mobile"?m:f;tab.querySelector(".cn").textContent=c;});}
renderT();updateStats();
})();
</script>
</body>
</html>
